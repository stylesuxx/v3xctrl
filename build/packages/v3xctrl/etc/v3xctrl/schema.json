{
  "title": "Configuration",
  "type": "object",
  "options": {
    "disable_collapse": true,
    "disable_edit_json": true,
    "disable_properties": true
  },
  "properties": {
    "server": {
      "propertyOrder": 10,
      "title": "Server",
      "type": "object",
      "options": {
        "collapsed": false,
        "disable_edit_json": true,
        "disable_properties": true
      },
      "properties": {
        "mode": {
          "propertyOrder": 10,
          "title": "Connection Mode",
          "type": "string",
          "enum": ["direct", "relay"],
          "required": true,
          "default": "direct",
          "description": "Choose how the client connects to the server."
        },
        "host": {
          "propertyOrder": 20,
          "type": "string",
          "title": "Host",
          "default": "192.168.0.1",
          "description": "Used in direct mode only"
        },
        "relaySessionId": {
          "propertyOrder": 30,
          "type": "string",
          "title": "Relay Session ID",
          "default": "test123",
          "description": "Needs to be the same on client and server"
        },
        "relayServer": {
          "propertyOrder": 40,
          "type": "string",
          "title": "UDP Relay Server",
          "default": "rendezvous.websium.at:8888",
          "description": "Used in relay mode only (only change if you are using your own relay server)"
        }
      }
    },
    "video": {
      "propertyOrder": 30,
      "type": "object",
      "title": "Video",
      "options": {
        "collapsed": true,
        "disable_edit_json": true,
        "disable_properties": true
      },
      "properties": {
        "width": {
          "propertyOrder": 10,
          "title": "Width",
          "description": "Setting also needs to also be adjusted in the viewer",
          "type": "integer",
          "default": 1280
        },
        "height": {
          "propertyOrder": 20,
          "title": "Height",
          "description": "Setting also needs to also be adjusted in the viewer",
          "type": "integer",
          "default": 720
        },
        "framerate": {
          "propertyOrder": 30,
          "title":" FPS",
          "description": "Setting also needs to also be adjusted in the viewer",
          "type": "integer",
          "default": 30
        },
        "iFramePeriod": {
          "propertyOrder": 40,
          "type": "integer",
          "default": 15,
          "description": "Amount of frames between I frames"
        },
        "bitrate": {
          "propertyOrder": 50,
          "title": "Bitrate",
          "required": true,
          "type": "integer",
          "enum": [
            50000000,
            40000000,
            30000000,
            20000000,
            10000000,
            5000000,
            4000000,
            3000000,
            2800000,
            2600000,
            2400000,
            2200000,
            2000000,
            1800000,
            1600000,
            1400000,
            1200000,
            1000000,
            800000
          ],
          "options": {
            "enum_titles": [
              "50.0 Mbps (theoretical maximum for 4G, CAT-3)",
              "40.0 Mbps",
              "30.0 Mbps",
              "20.0 Mbps (realistic maximum for 4G, CAT-3)",
              "10.0 Mbps",
              "5.0 Mbps (theoretical maximum fro 4G, Cat-1)",
              "4.0 Mbps",
              "3.0 Mbps (realistic maximum for 4G, CAT-1)",
              "2.8 Mbps",
              "2.6 Mbps",
              "2.4 Mbps",
              "2.2 Mbps",
              "2.0 Mbps",
              "1.8 Mbps (Default for average 4G, CAT-1)",
              "1.6 Mbps",
              "1.4 Mbps",
              "1.2 Mbps",
              "1.0 Mbps",
              "800 kbps"
            ]
          },
          "default": 1800000,
          "description": "Make sure you stay below values your modem supports (based on category) - if latency increases, you know you went to high."
        },
        "record": {
          "propertyOrder": 60,
          "type": "boolean",
          "format": "checkbox",
          "default": false,
          "description": "Record video stream to the client (make sure to use a high quality SD card)"
        },
        "recordPath": {
          "propertyOrder": 70,
          "title": "Record Path",
          "type": "string",
          "default": "/data/recordings",
          "description": "Path to store recordings"
        },
        "testSource": {
          "propertyOrder": 80,
          "title": "Test image",
          "type": "boolean",
          "format": "checkbox",
          "default": true,
          "description": "Use test image instead of camera - great for debugging, disable once you made sure video transmission is working"
        },
        "camera": {
          "propertyOrder": 90,
          "type": "object",
          "title": "Camera Settings",
          "options": {
            "collapsed": false,
            "disable_edit_json": true,
            "disable_properties": true
          },
          "properties": {
            "enableHdr": {
              "propertyOrder": 10,
              "title": "Enable HDR",
              "description": "Only supported on PiCam V3 - highly recommended (more FOV and better handling of dark/bright transitions)",
              "type": "boolean",
              "format": "checkbox",
              "default": false
            }
          }
        }
      }
    },
    "network": {
      "propertyOrder": 40,
      "type": "object",
      "title": "Network",
      "options": {
        "collapsed": true,
        "disable_edit_json": true,
        "disable_properties": true
      },
      "properties": {
        "ports": {
          "propertyOrder": 10,
          "type": "object",
          "title": "Ports",
          "options": {
            "collapsed": false,
            "disable_edit_json": true,
            "disable_properties": true
          },
          "properties": {
            "video": {
              "propertyOrder": 10,
              "type": "integer",
              "default": 6666,
              "description": "The port to which video will be streamed to"
            },
            "control": {
              "propertyOrder": 20,
              "type": "integer",
              "default": 6668,
              "description": "The port for the bi-directional control channel"
            },
            "webinterface": {
              "propertyOrder": 30,
              "type": "integer",
              "default": 5000,
              "description": "The port on which this interface should be running (requires reboot)"
            }
          }
        },
        "wifi": {
          "propertyOrder": 20,
          "type": "object",
          "title": "WiFi",
          "options": {
            "collapsed": false,
            "disable_edit_json": true,
            "disable_properties": true
          },
          "properties": {
            "mode": {
              "type": "string",
              "required": true,
              "enum": [
                "client",
                "ap"
              ],
              "description": "In client mode, the device will connect to the configured network. In access-point mode, the device will spawn it's own WiFi network to which you can connect"
            },
            "routing": {
              "type": "string",
              "required": true,
              "enum": [
                "wlan",
                "rndis"
              ],
              "description": "Which device should be used to route internet traffic. During setup use wlan and switch to rndis once everything ist setup and tested"
            }
          }
        },
        "modem": {
          "propertyOrder": 30,
          "type": "object",
          "title": "Modem",
          "options": {
            "collapsed": false,
            "disable_edit_json": true,
            "disable_properties": true
          },
          "properties": {
            "path": {
              "propertyOrder": 10,
              "title": "Path",
              "type": "string",
              "description": "Path to the modem device",
              "default": "/dev/ttyACM0"
            },
            "limitBands": {
              "title": "Limit Bands",
              "propertyOrder": 20,
              "type": "boolean",
              "format": "checkbox",
              "default": false,
              "description": "Sometimes it might be beneficial to limit 4G bands, only change this if you know what and why you are doing this. By default, this decision is left up to the firmware of your modem. Once set, this setting is persistent! Make sure you know which values are your modems default, so you can return to the correct ones."
            },
            "allowedBands": {
              "type": "array",
              "title": "Allowed Bands",
              "propertyOrder": 30,
              "items": {
                "type": "number",
                "enum": [
                  1,
                  3,
                  5,
                  7,
                  8,
                  20,
                  28,
                  34,
                  38,
                  39,
                  40,
                  41
                ]
              },
              "uniqueItems": true,
              "default": [1, 3, 7, 8, 20, 28]
            }
          }
        }
      }
    },
    "autostart": {
      "propertyOrder": 50,
      "type": "object",
      "title": "Autostart",
      "options": {
        "collapsed": true,
        "disable_edit_json": true,
        "disable_properties": true
      },
      "description": "Before enabling autostart, make sure that the services work fine when started manually.",
      "properties": {
        "video": {
          "propertyOrder": 10,
          "type": "boolean",
          "format": "checkbox",
          "default": true,
          "description": "Automatically start video stream after boot"
        },
        "control": {
          "propertyOrder": 20,
          "type": "boolean",
          "format": "checkbox",
          "default": true,
          "description": "Automatically start control channel after boot"
        }
      }
    },
    "controls": {
      "propertyOrder": 60,
      "type": "object",
      "title": "Controls",
      "options": {
        "collapsed": true,
        "disable_edit_json": true,
        "disable_properties": true
      },
      "properties": {
        "throttle": {
          "propertyOrder": 10,
          "type": "object",
          "title": "Throttle",
          "options": {
            "collapsed": false,
            "disable_edit_json": true,
            "disable_properties": true
          },
          "properties": {
            "min": {
              "propertyOrder": 10,
              "type": "integer",
              "default": 1000,
              "description": "Minimum pulse width"
            },
            "max": {
              "propertyOrder": 20,
              "type": "integer",
              "default": 2000,
              "description": "Maximum pulse width"
            },
            "failsafe": {
              "propertyOrder": 30,
              "type": "integer",
              "default": 1000,
              "description": "Pulse width when failsafe"
            },
            "idle": {
              "propertyOrder": 40,
              "type": "integer",
              "default": 1200,
              "description": "Pulsewidth for throttle position between forwards and brake/backwards"
            },
            "scaleForward": {
              "propertyOrder": 50,
              "type": "integer",
              "default": 100,
              "minimum": 1,
              "maximum": 100,
              "description": "Scales the throttle forward range as a percentage of the maximum possible value"
            },
            "scaleReverse": {
              "propertyOrder": 60,
              "type": "integer",
              "default": 100,
              "minimum": 1,
              "maximum": 100,
              "description": "Scales the throttle reverse range as a percentage of the maximum possible value"
            },
            "minForward": {
              "propertyOrder": 70,
              "type": "integer",
              "default": 0,
              "description": "Compensate for 'dead-zone' of ESC. Set this to a value just slightly before the motor starts spinning forward."
            },
            "minReverse": {
              "propertyOrder": 80,
              "type": "integer",
              "default": 0,
              "description": "Compensate for 'dead-zone' of ESC. Set this to a value just slightly before the motor starts spinning reverse."
            }
          }
        },
        "steering": {
          "propertyOrder": 20,
          "type": "object",
          "title": "Steering",
          "options": {
            "collapsed": false,
            "disable_edit_json": true,
            "disable_properties": true
          },
          "properties": {
            "min": {
              "propertyOrder": 10,
              "type": "integer",
              "default": 1000,
              "description": "Minimum pulse width"
            },
            "max": {
              "propertyOrder": 20,
              "type": "integer",
              "default": 2000,
              "description": "Maximum pulse width"
            },
            "failsafe": {
              "propertyOrder": 30,
              "type": "integer",
              "default": 1500,
              "description": "Pulse width when failsafe"
            },
            "trim": {
              "propertyOrder": 40,
              "type": "integer",
              "default": 0,
              "description": "Pulse width for trim"
            },
            "scale": {
              "propertyOrder": 50,
              "title": "Scale (in percent)",
              "type": "integer",
              "default": 100,
              "minimum": 1,
              "maximum": 100,
              "description": "Scales the steering output range as a percentage of the maximum possible value"
            },
            "invert": {
              "propertyOrder": 60,
              "title": "Invert steering",
              "type": "boolean",
              "format": "checkbox",
              "default": false,
              "description": "Invert steering direction"
            }
          }
        },
        "failsafeTimeout": {
          "propertyOrder": 30,
          "type": "integer",
          "default": 3,
          "description": "After this many seconds without a control packet, failsafe is triggered"
        },
        "gpio":{
          "propertyOrder":40,
          "type": "object",
          "title": "Pin Mapping",
          "options": {
          "collapsed": false,
          "disable_edit_json": true,
          "disable_properties": true
          },
          "properties": {
              "throttle": {
              "propertyOrder": 10,
              "type": "integer",
              "default": 18,
              "description": "GPIO for ESC"
            },
            "steering": {
              "propertyOrder": 20,
              "type": "integer",
              "default": 13,
              "description": "GPIO for Servo"
            }
          }
        }
      }
    },
    "telemetry": {
      "propertyOrder": 70,
      "type": "object",
      "title": "Telemetry",
      "options": {
        "collapsed": true,
        "disable_edit_json": true,
        "disable_properties": true
      },
      "properties": {
        "battery": {
          "title": "Battery",
          "propertyOrder": 10,
          "type": "object",
          "options": {
            "collapsed": false,
            "disable_edit_json": true,
            "disable_properties": true
          },
          "properties": {
            "i2cAddress": {
              "title": "I2C Address",
              "propertyOrder": 10,
              "type": "string",
              "required": true,
              "default": "0x40",
              "description": "I2C address of the INA sensor"
            },
            "minVoltage": {
              "title": "Minimum Voltage",
              "propertyOrder": 20,
              "type": "number",
              "required": true,
              "default": 3.5,
              "description": "Minimum voltage per cell (used to calculate battery percentage)"
            },
            "maxVoltage": {
              "title": "Maximum Voltage",
              "propertyOrder": 30,
              "type": "number",
              "required": true,
              "default": 4.2,
              "description": "Maximum voltage per cell (used to calculate battery percentage)"
            },
            "warnVoltage": {
              "title": "Warning Voltage",
              "propertyOrder": 40,
              "type": "number",
              "required": true,
              "default": 3.7,
              "description": "Level at which low voltage warnings should be triggered"
            }
          }
        }
      }
    },
    "extras": {
      "propertyOrder": 80,
      "type": "object",
      "title": "Extras",
      "options": {
        "collapsed": true,
        "disable_edit_json": true,
        "disable_properties": true
      },
      "properties": {
        "samba": {
          "title": "SAMBA",
          "propertyOrder": 10,
          "type": "boolean",
          "format": "checkbox",
          "default": false,
          "description": "Enable SAMBA network share for recording directory"
        },
        "logLevel": {
          "title": "Log Level",
          "propertyOrder": 20,
          "type": "string",
          "required": true,
          "default": "ERROR",
          "enum": [
            "CRITICAL",
            "ERROR",
            "WARNING",
            "INFO",
            "DEBUG"
          ]
        }
      }
    }
  }
}