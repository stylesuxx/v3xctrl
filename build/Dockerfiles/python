FROM arm64v8/debian:trixie

ENV DEBIAN_FRONTEND=noninteractive

# Install base tools and deps for Python build
RUN apt update
RUN apt install -y \
  build-essential \
  curl \
  dphys-swapfile \
  libbz2-dev \
  libctypes-ocaml-dev \
  libcurses-ocaml-dev \
  libdb-dev \
  libffi-dev \
  libgdbm-compat-dev \
  libgdbm-dev \
  liblzma-dev \
  libncursesw5-dev \
  libreadline-dev \
  libsqlite3-dev \
  libssl-dev \
  lintian \
  tk-dev \
  uuid-dev \
  zlib1g-dev

# Copy build script and source files
COPY . /src
WORKDIR /src

# Run the build script
RUN ./build/build-python.sh "/src"
