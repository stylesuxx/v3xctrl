FROM arm64v8/debian:trixie

ENV DEBIAN_FRONTEND=noninteractive

# Install base tools and deps for package build
RUN apt-get update
RUN apt-get install -y \
  libcairo2-dev \
  libgirepository1.0-dev \
  lintian \
  ca-certificates

# Copy and install v3xctrl-python.deb
COPY v3xctrl-python.deb /tmp/
RUN dpkg -i /tmp/v3xctrl-python.deb || apt-get install -f -y

# Copy build script and source files
COPY . /src
WORKDIR /src

# Run the build script
RUN ./build/build-v3xctrl.sh "/src"
